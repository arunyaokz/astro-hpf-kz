---
import BaseHead from '../components/BaseHead.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';
import AppleHeroSection from '../components/AppleHeroSection.astro';
import ProductsSection from '../components/ProductsSection.astro';
import SolutionsSection from '../components/SolutionsSection.astro';
import AppleRouteTracking from '../components/AppleRouteTracking.astro';
import AppleCustomerReviews from '../components/AppleCustomerReviews.astro';
import AboutSection from '../components/AboutSection.astro';
import ContactSection from '../components/ContactSection.astro';
import { SITE_TITLE, SITE_DESCRIPTION, TRANSLATIONS, TRACKING_DATA, CUSTOMER_REVIEWS } from '../consts';
---

<!doctype html>
<html lang="zh-CN">
	<head>
		<BaseHead title={SITE_TITLE} description={SITE_DESCRIPTION} />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="theme-color" content="#5751D5">
		
		<!-- 添加中文字体预加载 -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		
		<!-- 结构化数据 -->
		<script type="application/ld+json">
		{
		  "@context": "https://schema.org",
		  "@type": "Organization",
		  "name": "HPF KZ",
		  "description": "和光同尘 · 共创未来 | 以道德经智慧指导现代商业实践",
		  "url": "https://hpfkz.com",
		  "logo": "https://hpfkz.com/logo.png",
		  "foundingDate": "2019",
		  "founder": {
		    "@type": "Person",
		    "name": "HPF KZ Team"
		  },
		  "address": {
		    "@type": "PostalAddress",
		    "streetAddress": "深圳湾科技生态园",
		    "addressLocality": "深圳",
		    "addressRegion": "广东",
		    "addressCountry": "CN"
		  },
		  "contactPoint": {
		    "@type": "ContactPoint",
		    "telephone": "+86-188-8888-8888",
		    "contactType": "customer service",
		    "email": "info@hpfkz.com"
		  },
		  "sameAs": [
		    "https://weibo.com/hpfkz",
		    "https://www.linkedin.com/company/hpfkz"
		  ]
		}
		</script>
	</head>
	<body>
		<!-- 网站头部 -->
		<Header />
		
		<!-- 主要内容区域 -->
		<main>
			<!-- Apple风格Hero区域 -->
			<AppleHeroSection />
			
			<!-- 核心产品区域 -->
			<ProductsSection />
			
			<!-- 行业解决方案区域 -->
			<SolutionsSection />
			
			<!-- 实时路线追踪区域 -->
			<AppleRouteTracking />
			
			<!-- 客户评价区域 -->
			<AppleCustomerReviews />
			
			<!-- 关于我们区域 -->
			<AboutSection />
			
			<!-- 联系我们区域 -->
			<ContactSection />
		</main>
		
		<!-- 网站底部 -->
		<Footer />
		
		<!-- 全局样式 -->
		<style>
			/* Apple风格页面样式 */
			main {
				padding-top: 0; /* Apple Hero已经处理了header间距 */
			}
			
			/* 平滑滚动 */
			html {
				scroll-behavior: smooth;
			}
			
			/* 全局字体优化 */
			body {
				font-feature-settings: "kern" 1, "liga" 1, "calt" 1;
				text-rendering: optimizeLegibility;
				-webkit-font-smoothing: antialiased;
				-moz-osx-font-smoothing: grayscale;
			}
			
			/* 选择文本样式 */
			::selection {
				background-color: var(--accent-primary);
				color: var(--bg-primary);
			}
			
			/* 滚动条样式 */
			::-webkit-scrollbar {
				width: 8px;
			}
			
			::-webkit-scrollbar-track {
				background: rgba(22, 22, 21, 0.05);
			}
			
			::-webkit-scrollbar-thumb {
				background: rgba(87, 81, 213, 0.3);
				border-radius: 4px;
			}
			
			::-webkit-scrollbar-thumb:hover {
				background: rgba(87, 81, 213, 0.5);
			}
			
			/* 响应式字体大小调整 */
			@media (max-width: 768px) {
				main {
					padding-top: 60px;
				}
			}
			
			/* 打印样式 */
			@media print {
				.site-header,
				.mobile-menu,
				.hero-actions,
				.contact-form {
					display: none;
				}
				
				body {
					background: white !important;
					color: black !important;
				}
				
				.accent-number,
				.text-accent {
					color: black !important;
				}
			}
			
			/* 高对比度模式支持 */
			@media (prefers-contrast: high) {
				:root {
					--bg-primary: #ffffff;
					--text-primary: #000000;
					--accent-primary: #0000ff;
					--text-secondary: #333333;
				}
			}
			
			/* 动画减少偏好支持 */
			@media (prefers-reduced-motion: reduce) {
				* {
					animation-duration: 0.01ms !important;
					animation-iteration-count: 1 !important;
					transition-duration: 0.01ms !important;
				}
			}
			
			/* 暗色主题偏好支持 */
			@media (prefers-color-scheme: dark) {
				/* 如需支持暗色主题，可在此处添加相应样式 */
			}
			
			/* Focus 可见性改进 */
			.btn:focus-visible,
			.nav-link:focus-visible,
			.form-input:focus-visible,
			.form-select:focus-visible,
			.form-textarea:focus-visible {
				outline: 2px solid var(--accent-primary);
				outline-offset: 2px;
			}
			
			/* 无障碍性改进 */
			.sr-only {
				position: absolute;
				width: 1px;
				height: 1px;
				padding: 0;
				margin: -1px;
				overflow: hidden;
				clip: rect(0, 0, 0, 0);
				white-space: nowrap;
				border: 0;
			}
			
			/* 加载状态 */
			.loading {
				opacity: 0.7;
				pointer-events: none;
				cursor: wait;
			}
			
			/* 错误状态 */
			.error {
				border-color: #dc2626 !important;
				background-color: rgba(220, 38, 38, 0.05);
			}
			
			/* 成功状态 */
			.success {
				border-color: #059669 !important;
				background-color: rgba(5, 150, 105, 0.05);
			}
		</style>
		
		<!-- 全局数据注入 -->
		<script define:vars={{ TRANSLATIONS, TRACKING_DATA, CUSTOMER_REVIEWS }}>
			// 将数据注入到全局作用域
			window.TRANSLATIONS = TRANSLATIONS;
			window.TRACKING_DATA = TRACKING_DATA;
			window.CUSTOMER_REVIEWS = CUSTOMER_REVIEWS;
		</script>

		<!-- 页面级别的JavaScript -->
		<script>
			// 页面加载完成后的初始化
			document.addEventListener('DOMContentLoaded', function() {
				// 添加页面加载动画
				document.body.classList.add('loaded');
				
				// 延迟加载图片
				if ('IntersectionObserver' in window) {
					const imageObserver = new IntersectionObserver((entries) => {
						entries.forEach(entry => {
							if (entry.isIntersecting) {
								const img = entry.target;
								img.src = img.dataset.src;
								img.classList.remove('lazy');
								imageObserver.unobserve(img);
							}
						});
					});
					
					document.querySelectorAll('img[data-src]').forEach(img => {
						imageObserver.observe(img);
					});
				}
				
				// 页面可见性 API - 优化性能
				document.addEventListener('visibilitychange', function() {
					if (document.hidden) {
						// 页面隐藏时暂停动画
						document.querySelectorAll('.aurora-float').forEach(el => {
							el.style.animationPlayState = 'paused';
						});
					} else {
						// 页面显示时恢复动画
						document.querySelectorAll('.aurora-float').forEach(el => {
							el.style.animationPlayState = 'running';
						});
					}
				});
				
				// 性能监控
				if ('performance' in window && 'getEntriesByType' in performance) {
					window.addEventListener('load', function() {
						setTimeout(() => {
							const navigation = performance.getEntriesByType('navigation')[0];
							const loadTime = navigation.loadEventEnd - navigation.fetchStart;
							console.log(`Page load time: ${loadTime}ms`);
							
							// 在生产环境中，可以将这些数据发送到分析服务
							if (loadTime > 3000) {
								console.warn('Page load time is slower than expected');
							}
						}, 0);
					});
				}
			});
			
			// 错误处理
			window.addEventListener('error', function(e) {
				console.error('Page error:', e.error);
				// 在生产环境中，可以将错误信息发送到监控服务
			});
			
			// 未捕获的Promise异常处理
			window.addEventListener('unhandledrejection', function(e) {
				console.error('Unhandled promise rejection:', e.reason);
				// 在生产环境中，可以将错误信息发送到监控服务
			});
		</script>
	</body>
</html>